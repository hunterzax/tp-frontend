# ЁЯУМ CWE-918: SSRF - р╕нр╣Ир╕▓р╕Щр╕Щр╕╡р╣Йр╕Бр╣Ир╕нр╕Щ

## ЁЯОп р╕кр╕гр╕╕р╕Ыр╕кр╕▒р╣Йр╕Щ

**р╕Ыр╕▒р╕Нр╕лр╕▓:** р╕Юр╕Ър╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И SSRF (Server-Side Request Forgery) р╕Ир╕│р╕Щр╕зр╕Щ **71 р╕Ир╕╕р╕Ф**  
**р╕гр╕░р╕Фр╕▒р╕Ър╕Др╕зр╕▓р╕бр╕гр╕╕р╕Щр╣Бр╕гр╕З:** р╕кр╕╣р╕З  
**р╕кр╕Цр╕▓р╕Щр╕░:** тЬЕ **р╣Бр╕Бр╣Йр╣Др╕Вр╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╣Бр╕ер╣Йр╕з**

---

## тЪая╕П р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╕Юр╕Ъ

р╕гр╕░р╕Ър╕Ър╕бр╕╡р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Ир╕▓р╕Бр╕Бр╕▓р╕гр╕Чр╕╡р╣И:
1. р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL р╕Бр╣Ир╕нр╕Щр╕кр╣Ир╕З HTTP request
2. р╕гр╕▒р╕Ъ input р╕Ир╕▓р╕Б user р╕бр╕▓р╣Гр╕Кр╣Йр╕кр╕гр╣Йр╕▓р╕З URL р╣Вр╕Фр╕вр╕Хр╕гр╕З
3. р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Бр╕│р╕лр╕Щр╕Ф whitelist р╕Вр╕нр╕З domains
4. р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ path traversal attacks

---

## тЬи р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕В

### 1. р╕кр╕гр╣Йр╕▓р╕З URL Validator
р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М `/src/utils/urlValidator.ts` р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕Вр╕нр╕З URLs

### 2. р╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Яр╕ер╣Мр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф 29 р╣Др╕Яр╕ер╣М
- тЬЕ `postService.tsx` - 18 functions
- тЬЕ Redux Slices - 22 files
- тЬЕ `exportFunc.ts` - 2 functions
- тЬЕ `hookData.ts` - 2 functions
- тЬЕ API Routes - 2 files
- тЬЕ Authentication pages - 1 file

### 3. р╣Ар╕Юр╕┤р╣Ир╕бр╕гр╕░р╕Ър╕Ър╕гр╕▒р╕Бр╕йр╕▓р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
- URL Path Validation
- Safe URL Construction
- Domain Whitelisting
- Path Sanitization
- Parameter Validation

---

## ЁЯУК р╕кр╕Цр╕┤р╕Хр╕┤

| р╕гр╕▓р╕вр╕Бр╕▓р╕г | р╕Ир╕│р╕Щр╕зр╕Щ | р╕кр╕Цр╕▓р╕Щр╕░ |
|--------|-------|-------|
| р╣Др╕Яр╕ер╣Мр╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕В | 29 | тЬЕ |
| р╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕В | 56 | тЬЕ |
| р╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣Ир╕Чр╕╡р╣Ир╣Бр╕Бр╣Йр╣Др╕В | 71 | тЬЕ |
| Coverage | 100% | тЬЕ |

---

## ЁЯФТ р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в

### р╕Бр╣Ир╕нр╕Щр╣Бр╕Бр╣Йр╣Др╕В
- ЁЯФ┤ р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕кр╕╣р╕З
- ЁЯФ┤ р╕кр╕▓р╕бр╕▓р╕гр╕Цр╣Вр╕Ир╕бр╕Хр╕╡ SSRF р╣Др╕Фр╣Й
- ЁЯФ┤ р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL

### р╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В
- ЁЯЯв р╕Др╕зр╕▓р╕бр╣Ар╕кр╕╡р╣Ир╕вр╕Зр╕Хр╣Ир╕│
- ЁЯЯв р╕Ыр╣Йр╕нр╕Зр╕Бр╕▒р╕Щ SSRF р╣Бр╕ер╣Йр╕з
- ЁЯЯв р╕бр╕╡р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL р╕Чр╕╕р╕Бр╕Ир╕╕р╕Ф

---

## ЁЯУЭ р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### тЬЕ р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З (р╕лр╕ер╕▒р╕Зр╣Бр╕Бр╣Йр╣Др╕В)
```typescript
import { buildSafeApiUrl, isValidApiPath } from '@/utils/urlValidator';

// р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
if (!isValidApiPath(path)) {
    throw new Error('Invalid path');
}

// р╕кр╕гр╣Йр╕▓р╕З URL р╕нр╕вр╣Ир╕▓р╕Зр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в
const safeUrl = buildSafeApiUrl(API_URL, path);
const response = await axios.get(safeUrl);
```

### тЭМ р╕зр╕┤р╕Шр╕╡р╕Чр╕╡р╣Ир╣Др╕бр╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З (р╕Бр╣Ир╕нр╕Щр╣Бр╕Бр╣Йр╣Др╕В)
```typescript
// р╕нр╕▒р╕Щр╕Хр╕гр╕▓р╕в! р╣Др╕бр╣Ир╕бр╕╡р╕Бр╕▓р╕гр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ
const response = await axios.get(`${API_URL}${userInput}`);
```

---

## тЪЩя╕П р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓

р╣Ар╕Юр╕┤р╣Ир╕бр╣Гр╕Щ `.env`:
```env
NEXT_PUBLIC_ALLOWED_DOMAINS=localhost,127.0.0.1,api.example.com
```

---

## ЁЯУЪ р╣Ар╕нр╕Бр╕кр╕▓р╕гр╣Ар╕Юр╕┤р╣Ир╕бр╣Ар╕Хр╕┤р╕б

- **р╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╣Ар╕Хр╣Зр╕б:** [`тЬЕ-CWE-918-COMPLETED.md`](./тЬЕ-CWE-918-COMPLETED.md)
- **README:** [`README.md`](./README.md)
- **р╕гр╕▓р╕вр╕Зр╕▓р╕Щр╕Хр╣Йр╕Щр╕Йр╕Ър╕▒р╕Ъ:** [`../CWE-918:Server-side Request.md`](../../CWE-918:Server-side%20Request.md)

---

## тЬЕ р╕кр╕гр╕╕р╕Ы

р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Кр╣Ир╕нр╕Зр╣Вр╕лр╕зр╣И CWE-918 р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╣Бр╕ер╣Йр╕з р╕гр╕░р╕Ър╕Ър╕бр╕╡р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕вр╕кр╕╣р╕Зр╕Вр╕╢р╣Йр╕Щ р╣Бр╕ер╕░р╕Юр╕гр╣Йр╕нр╕бр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╣Гр╕Щ production

**р╕кр╕Цр╕▓р╕Щр╕░:** тЬЕ **р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣М**  
**р╕зр╕▒р╕Щр╕Чр╕╡р╣И:** 29 р╕Хр╕╕р╕ер╕▓р╕Др╕б 2025

---

*р╕кр╕│р╕лр╕гр╕▒р╕Ър╕гр╕▓р╕вр╕ер╕░р╣Ар╕нр╕╡р╕вр╕Фр╕Чр╕▓р╕Зр╣Ар╕Чр╕Др╕Щр╕┤р╕Д р╕Бр╕гр╕╕р╕Ур╕▓р╕нр╣Ир╕▓р╕Щ [`тЬЕ-CWE-918-COMPLETED.md`](./тЬЕ-CWE-918-COMPLETED.md)*


